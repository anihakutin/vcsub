<%= form_with(model: listing, class: "max-w-2xl mx-auto") do |form| %>
  <% if listing.errors.any? %>
    <div class="bg-red-50 p-4 rounded mb-6">
      <h2><%= pluralize(listing.errors.count, "error") %> prevented this listing from being saved:</h2>
      <ul>
        <% listing.errors.each do |error| %>
          <li><%= error.full_message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="space-y-6">
    <div>
      <%= form.label :title, class: "block text-sm font-medium text-gray-700" %>
      <%= form.text_field :title, class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" %>
    </div>

    <div>
      <%= form.label :category, class: "block text-sm font-medium text-gray-700" %>
      <%= form.select :category, [
        "Office Furniture (Barely Sat On)",
        "Hardware (Macbook, Raspberry Pi, Sonos, etc.)",
        "Unused Ping Pong Tables",
        "Promotional Swag",
        "Fancy Coffee Machines",
        "Abandoned Code Repositories",
        "Motivational Posters",
        "Untouched Exercise Equipment",
        "Blockchain Whitepapers",
        "Employees (Highly Skilled)",
      ], {}, class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" %>
    </div>

    <div>
      <%= form.label :condition, class: "block text-sm font-medium text-gray-700" %>
      <%= form.select :condition, [
        "Like New (Never Had Time to Use It)",
        "Gently Used (During Our Series A)",
        "Well-Loved (Survived Multiple Pivots)",
        "Battle-Scarred (Been Through YC)"
      ], {}, class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" %>
    </div>

    <div>
      <%= form.label :images, class: "block text-sm font-medium text-gray-700" %>
      <% if listing.images.attached? %>
        <div class="mt-2 grid grid-cols-2 gap-4 mb-4">
          <% listing.images.each do |image| %>
            <div class="relative">
              <%= image_tag image.variant(:thumb), class: "rounded-lg" %>
              <%= form.hidden_field :images, multiple: true, value: image.signed_id %>
            </div>
          <% end %>
        </div>
        <p class="text-sm text-gray-500 mb-2">Add more images:</p>
      <% end %>
      <%= form.file_field :images, multiple: true, class: "mt-1 block w-full", 
          accept: 'image/png,image/jpeg,image/jpg' %>
    </div>

    <div>
      <%= form.label :initial_valuation, "Startup Valuation at Time of Purchase", 
          class: "block text-sm font-medium text-gray-700" %>
      <div class="mt-1 relative rounded-md shadow-sm">
        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
          <span class="text-gray-500 sm:text-sm">$</span>
        </div>
        <%= form.number_field :initial_valuation, step: :any, 
            class: "pl-7 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" %>
      </div>
    </div>

    <div>
      <%= form.label :runway_end_date, "Runway End Date (when the money runs out)", 
          class: "block text-sm font-medium text-gray-700" %>
      <%= form.date_field :runway_end_date, 
          class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" %>
    </div>

    <div>
      <%= form.label :price, class: "block text-sm font-medium text-gray-700" %>
      <div class="mt-1 relative rounded-md shadow-sm">
        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
          <span class="text-gray-500 sm:text-sm">$</span>
        </div>
        <%= form.number_field :price, step: :any, class: "pl-7 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" %>
      </div>
    </div>

    <div>
      <%= form.label :description, class: "block text-sm font-medium text-gray-700" %>
      <%= form.text_area :description, rows: 4, class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" %>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
      <div>
        <%= form.label :city, class: "block text-sm font-medium text-gray-700" %>
        <%= form.text_field :city, 
            class: "mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" %>
      </div>

      <div>
        <%= form.label :state, class: "block text-sm font-medium text-gray-700" %>
        <%= form.select :state, 
            us_states_options,
            { include_blank: "Select State" },
            class: "mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" %>
      </div>

      <div>
        <%= form.label :zip_code, class: "block text-sm font-medium text-gray-700" %>
        <%= form.text_field :zip_code, 
            class: "mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" %>
      </div>
    </div>

    <div>
      <%= form.submit listing.persisted? ? "Update Listing" : "List It (Before the Money Runs Out)", 
          class: "w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500" %>
    </div>
  </div>
<% end %> 